<!DOCTYPE html>
<html>
  <head>
    <title>WAT INTERVIEW</title>
    <!-- Favicon using emoji -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üá∫üá∏</text></svg>"
    />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <!-- Custom CSS -->
    <style>
      body {
        background-color: #f8f9fa;
        padding: 20px;
        padding-top: 130px;
      }
      strong {
        color: #0d6efd;
        font-weight: 600;
      }
      .btn-outline-danger:hover {
        background-color: #dc3545;
        color: white;
      }

      .btn-outline-secondary:hover {
        background-color: #6c757d;
        color: white;
      }

      .card {
        margin-bottom: 20px;
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
      }
      .card:hover {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .row > [class*="col-"] {
        padding-bottom: 20px;
      }
      .card:hover {
        transform: translateY(-5px);
      }
      .question {
        font-weight: 600;
        color: #2c3e50;
        font-size: 1.1rem;
      }
      .answer {
        display: none;
        margin-top: 15px;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 5px;
        border-left: 4px solid #0d6efd;
      }
      .language-toggle {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background-color: rgba(255, 255, 255, 0.95);
        padding: 1rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .badge {
        font-size: 0.9rem;
        padding: 0.35em 0.65em;
        font-weight: 500;
      }
      .language-toggle .btn-danger {
        margin-top: 10px;
        padding: 0.5rem 2rem;
      }
      .btn-group {
        margin-bottom: 10px;
      }
      @media (max-width: 768px) {
        .card {
          margin-bottom: 10px;
        }
        .question {
          font-size: 4rem;
        }
        .card-body {
          padding: 1rem;
        }
        body {
          padding-top: 150px;
        }
      }

      .btn-success {
        background-color: #28a745;
        border-color: #28a745;
      }

      .btn-success:hover {
        background-color: #218838;
        border-color: #1e7e34;
      }

      /* Modal –¥—ç—ç—Ä—Ö —Ç–æ–≤—á–Ω—É—É–¥—ã–Ω –∑–∞–≥–≤–∞—Ä */
      .modal .btn-primary,
      .modal .btn-secondary {
        padding: 0.5rem 1.5rem;
      }

      /* Card –¥—ç—ç—Ä—Ö –∑–∞—Å–∞—Ö/—É—Å—Ç–≥–∞—Ö —Ç–æ–≤—á–Ω—É—É–¥—ã–Ω –∑–∞–≥–≤–∞—Ä */
      .card .btn-outline-secondary,
      .card .btn-outline-danger {
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
      }
    </style>
  </head>
  <body>
    <!-- Header buttons -->
    <div class="text-center mb-4">
      <h1>Wat Interview Questions</h1>
      <button
        class="btn btn-primary me-2"
        data-bs-toggle="modal"
        data-bs-target="#addQuestionModal"
      >
        Add Question
      </button>
      <!-- –ê–¥–º–∏–Ω —Ö—ç—Å—ç–≥—Ç –Ω—ç–º—ç—Ö -->
      <!-- <button
        class="btn btn-warning"
        onclick="uploadQuestionsToFirebase()"
        title="Upload all questions to database"
      >
        <i class="fas fa-upload"></i> Upload Questions
      </button> -->
    </div>

    <!-- Language toggle buttons -->
    <div class="language-toggle text-center mb-4">
      <div class="btn-group">
        <button
          class="btn btn-outline-primary"
          onclick="toggleLanguage('en-answer')"
        >
          English
        </button>
        <button
          class="btn btn-outline-primary"
          onclick="toggleLanguage('mn-answer')"
        >
          –ú–æ–Ω–≥–æ–ª
        </button>
        <button
          class="btn btn-outline-primary"
          onclick="toggleLanguage('both')"
        >
          Both
        </button>
        <button class="btn btn-secondary" onclick="hideAllAnswers()">
          Hide All Answers
        </button>
      </div>
    </div>

    <div class="container">
      <div id="qa-container" class="row">
        <!-- Questions will be loaded here -->
      </div>
    </div>

    <!-- Add Question Modal -->
    <div class="modal fade" id="addQuestionModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New Question</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="addQuestionForm">
              <div class="mb-3">
                <label class="form-label">Question:</label>
                <input
                  type="text"
                  class="form-control"
                  id="newQuestionInput"
                  required
                />
              </div>
              <div class="mb-3">
                <label class="form-label">English Answer:</label>
                <textarea
                  class="form-control"
                  id="newEnInput"
                  rows="3"
                  required
                ></textarea>
              </div>
              <div class="mb-3">
                <label class="form-label">Mongolian Answer:</label>
                <textarea
                  class="form-control"
                  id="newMnInput"
                  rows="3"
                  required
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="addNewQuestion()"
            >
              Add Question
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Question Modal -->
    <div class="modal fade" id="editQuestionModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Question</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editQuestionForm">
              <div class="mb-3">
                <label class="form-label">Question:</label>
                <input
                  type="text"
                  class="form-control"
                  id="editQuestionInput"
                  required
                />
              </div>
              <div class="mb-3">
                <label class="form-label">English Answer:</label>
                <textarea
                  class="form-control"
                  id="editEnInput"
                  rows="3"
                  required
                ></textarea>
              </div>
              <div class="mb-3">
                <label class="form-label">Mongolian Answer:</label>
                <textarea
                  class="form-control"
                  id="editMnInput"
                  rows="3"
                  required
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="saveEditedQuestion()"
            >
              Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add data.js script -->
    <!-- <script src="data.js"></script> -->

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JavaScript -->
    <script>
      function boldBracketedText(text) {
        return text.replace(/\[(.*?)\]/g, "<strong>[$1]</strong>");
      }

      function hideAllAnswers() {
        const answers = document.getElementsByClassName("answer");
        for (let answer of answers) {
          answer.style.display = "none";
        }

        // –ó”©–≤—Ö”©–Ω Answer —Ç–æ–≤—á—É—É–¥—ã–Ω —Ç–µ–∫—Å—Ç–∏–π–≥ ”©”©—Ä—á–ª”©—Ö
        const toggleBtns = document.querySelectorAll(
          ".card .btn-outline-primary, .card .btn-primary"
        );
        toggleBtns.forEach((btn) => {
          if (btn.textContent.includes("Answer")) {
            btn.textContent = "Show Answer";
            btn.classList.replace("btn-primary", "btn-outline-primary");
          }
        });

        // Language toggle —Ç–æ–≤—á—É—É–¥—ã–≥ outline –±–æ–ª–≥–æ—Ö
        const langButtons = document.querySelectorAll(".language-toggle .btn");
        langButtons.forEach((btn) => {
          btn.classList.add("btn-outline-primary");
          btn.classList.remove("btn-primary");
        });
      }

      function toggleAnswer(button) {
        const card = button.closest(".card-body");
        const answers = card.getElementsByClassName("answer");
        const isHidden =
          answers[0].style.display === "none" || !answers[0].style.display;

        for (let answer of answers) {
          answer.style.display = isHidden ? "block" : "none";
        }

        // –ó”©–≤—Ö”©–Ω Show/Hide Answer —Ç–æ–≤—á–Ω—ã —Ç–µ–∫—Å—Ç–∏–π–≥ ”©”©—Ä—á–ª”©—Ö
        if (isHidden) {
          button.textContent = "Hide Answer";
          button.classList.replace("btn-outline-primary", "btn-primary");
        } else {
          button.textContent = "Show Answer";
          button.classList.replace("btn-primary", "btn-outline-primary");
        }
      }

      function toggleLanguage(lang) {
        const buttons = document.querySelectorAll(".language-toggle .btn");
        buttons.forEach((btn) => {
          if (
            btn.textContent.toLowerCase().includes(lang) ||
            (lang === "both" && btn.textContent === "Both")
          ) {
            btn.classList.add("btn-primary");
            btn.classList.remove("btn-outline-primary");
          } else {
            btn.classList.add("btn-outline-primary");
            btn.classList.remove("btn-primary");
          }
        });

        const answers = document.getElementsByClassName("answer");
        for (let answer of answers) {
          if (lang === "both" || answer.classList.contains(lang)) {
            answer.style.display = "block";
          } else {
            answer.style.display = "none";
          }
        }

        // –ê—Å—É—É–ª—Ç –±“Ø—Ä–∏–π–Ω Show/Hide —Ç–æ–≤—á–Ω—ã —Ç–µ–∫—Å—Ç–∏–π–≥ —à–∏–Ω—ç—á–ª—ç—Ö
        const toggleBtns = document.querySelectorAll(
          ".card .btn-outline-primary, .card .btn-primary"
        );
        toggleBtns.forEach((btn) => {
          if (btn.textContent.includes("Answer")) {
            // –ó”©–≤—Ö”©–Ω Answer —Ç–æ–≤—á—É—É–¥—ã–≥ —à–∏–Ω—ç—á–ª—ç—Ö
            if (lang === "both" || answers[0].style.display === "block") {
              btn.textContent = "Hide Answer";
              btn.classList.replace("btn-outline-primary", "btn-primary");
            } else {
              btn.textContent = "Show Answer";
              btn.classList.replace("btn-primary", "btn-outline-primary");
            }
          }
        });
      }

      // DOM –∞—á–∞–∞–ª–∞–≥–¥—Å–∞–Ω—ã –¥–∞—Ä–∞–∞ createCards –¥—É—É–¥–∞—Ö
      document.addEventListener("DOMContentLoaded", function () {
        createCards();
      });
    </script>

    <!-- Firebase SDK - —Ö–∞–º–≥–∏–π–Ω —ç—Ö—ç–Ω–¥ –±–∞–π—Ä–ª—É—É–ª–∞—Ö -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <!-- Firebase —Ç–æ—Ö–∏—Ä–≥–æ–æ -->
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyD5NiYHI_2xPQvaOna_mwqCfmdDXFKOBhU",
        authDomain: "watinterview-34f9c.firebaseapp.com",
        projectId: "watinterview-34f9c",
        storageBucket: "watinterview-34f9c.firebasestorage.app",
        messagingSenderId: "255575163715",
        appId: "1:255575163715:web:17b0fdc071b6e1baf2e5f6",
        measurementId: "G-YNX8QW25DH",
      };

      // Firebase initialize
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
    </script>

    <!-- Questions data -->
    <script type="module" src="./questions.js"></script>

    <!-- Upload script -->
    <script type="module" src="./uploadData.js"></script>

    <!-- Main script -->
    <script type="module">
      import {
        initializeDatabase,
        createCards,
        editQuestion,
        deleteQuestion,
        addNewQuestion,
      } from "./uploadData.js";

      // Make functions available globally
      window.editQuestion = editQuestion;
      window.deleteQuestion = deleteQuestion;
      window.addNewQuestion = addNewQuestion;

      // Initialize when DOM is loaded
      document.addEventListener("DOMContentLoaded", async () => {
        try {
          await createCards();
        } catch (error) {
          console.error("Initialization error:", error);
        }
      });
    </script>
  </body>
</html>
